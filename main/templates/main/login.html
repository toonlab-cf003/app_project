{% extends 'main/base.html' %}
{% block title %}ãƒ­ã‚°ã‚¤ãƒ³{% endblock %}
{% load static %}

{% block content %}
<h1><span class="emoji">ğŸ‚</span> ãŸã‚“ã˜ã‚‡ã†ã³ã§ãƒ­ã‚°ã‚¤ãƒ³</h1>

<form method="POST" class="login_form">
  {% csrf_token %}

  <div class="form-block">
    <p>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </p>
    <input type="text" name="nickname" placeholder="ä¾‹ï¼šã§ãƒ¼ãŸã‚‚ã‚“" oninput="validateKana(this)" required>
    <br><br>

    <p>ã†ã¾ã‚ŒãŸæ—¥</p>
    <div class="pin-input">
      <input type="text" maxlength="1" inputmode="numeric" pattern="\d*" class="pin-digit" />
      <input type="text" maxlength="1" inputmode="numeric" pattern="\d*" class="pin-digit" />
      <input type="text" maxlength="1" inputmode="numeric" pattern="\d*" class="pin-digit" />
      <input type="text" maxlength="1" inputmode="numeric" pattern="\d*" class="pin-digit" />
    </div>
    <input type="hidden" name="password" id="password-hidden" required>

    <br>
    <button type="submit" class="btn btn-start">ãƒ­ã‚°ã‚¤ãƒ³</button>
  </div>
</form>


<!-- JavaScript -->
<script>
  // ã²ã‚‰ãŒãªãƒ»ã‚«ã‚¿ã‚«ãƒŠä»¥å¤–ã‚’é™¤å¤–
  function validateKana(input) {
    input.value = input.value.replace(/[^ã-ã‚“ã‚¡-ãƒ³ãƒ¼ã‚›ã‚œ]/g, '');
  }

  // PINå…¥åŠ›ï¼šæ•°å­—ã®ã¿ã€æ¬¡ã¸ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã€è‡ªå‹•çµåˆ
  const inputs = document.querySelectorAll('.pin-digit');
  const hidden = document.getElementById('password-hidden');

  inputs.forEach((input, i) => {
    input.addEventListener('input', () => {
      input.value = input.value.replace(/[^0-9]/g, '');
      if (input.value && i < inputs.length - 1) {
        inputs[i + 1].focus();
      }
      updateHidden();
    });
    input.addEventListener('keydown', (e) => {
      if (e.key === "Backspace" && !input.value && i > 0) {
        inputs[i - 1].focus();
      }
    });
  });

  function updateHidden() {
    hidden.value = Array.from(inputs).map(i => i.value).join('');
  }
</script>

{% endblock %}
