{% extends 'main/base.html' %}
{% load static %}
{% block title %}ãŠã‚ã§ã¨ã†ãƒšãƒ¼ã‚¸{% endblock %}
{% block body_class %}page-correct{% endblock %}

{% block content %}
<main class="main-content">
{% if saved %}
  <div class="saved-box">
    <h2>ã‚·ãƒ¼ãƒ«ã‚’ã‚²ãƒƒãƒˆï¼</h2>
    <img src="{% static 'stickers/' %}{{ saved_sticker }}" 
         alt="é¸ã‚“ã ã‚·ãƒ¼ãƒ«" width="100" height="100">
    <p>ã‚·ãƒ¼ãƒ«ã¯ã€<strong>{{ sticker_count }}</strong> ã¾ã„ ã‚ã¤ã¾ã£ã¦ã‚‹ã‚ˆï¼</p>
    <a href="{% url next_url %}" class="btn btn-next">ã¤ãã¸</a>
  </div>
  {# ç´™å¹é›ªï¼ˆCanvas Confettiï¼‰ #}
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    // ãµã‚ã£ã¨è¤‡æ•°å›
    function burst() {
      confetti({
        particleCount: 120,
        spread: 70,
        origin: { x: Math.random()*0.4 + 0.3, y: 0.6 } // ç”»é¢ä¸­å¤®ä»˜è¿‘
      });
    }
    // æœ€åˆã«ãƒ‰ãƒ³ï¼
    burst();
    // è¿½åŠ ã§æ•°å›
    setTimeout(burst, 400);
    setTimeout(burst, 900);
  </script>

{% else %}
  <form class="correct-page" action="{% url 'save_sticker' %}?next={{ next_url }}" method="post">
    {% csrf_token %}
    <div class="correct-message">
      <h1>ãŠã‚ã§ã¨ã†ğŸ‰æ­£è§£ã ã‚ˆï¼</h1>
      <p>â‘  ã‚·ãƒ¼ãƒ«ã‚’ãˆã‚‰ã¼ã†ï¼</p>
      <p>â‘¡ é¸ã‚“ã ã‚‰ã€ã‚·ãƒ¼ãƒ«ã‚’ã‚‚ã‚‰ã†ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã­</p>
      <input type="submit" value="ã‚·ãƒ¼ãƒ«ã‚’ã‚‚ã‚‰ã†" class="btn btn-wrong">
    </div>
    <div class="sticker-form">
      <small class="small-coment">ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§ãã‚‹ã‚ˆ</small>
      <div class="sticker-grid">
        {% for i in sticker_list %}
          <input type="radio" name="sticker" value="sticker_{{ i }}.jpg" id="sticker{{ i }}" required>
          <label for="sticker{{ i }}" class="sticker-label">
            <img src="{% static 'stickers/sticker_' %}{{ i }}.jpg" alt="ã‚·ãƒ¼ãƒ«{{ i }}">
          </label>
        {% endfor %}
      </div>
    </div>
  </form>
{% endif %}
</main>
{% endblock %}
